<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±</title>

    <meta name="theme-color" content="#8b0000">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±">
    
    <link rel="icon" type="image/png" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">
    <link rel="apple-touch-icon" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #8b0000; --bg: #f8f9fa; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 90px; -webkit-user-select: none; }
        
        /* ØªØµÙ…ÙŠÙ… Ø§Ù„Ù‡ÙŠØ¯Ø± Ø¨Ø´ÙƒÙ„ ÙŠØ´Ø¨Ù‡ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØ© */
        .app-bar { background: var(--primary); color: white; padding: 40px 15px 20px; text-align: center; position: sticky; top: 0; z-index: 1000; box-shadow: 0 2px 10px rgba(0,0,0,0.2); }
        .app-bar h1 { margin: 0; font-size: 1.4rem; }

        .search-container { padding: 10px 15px; background: var(--primary); padding-bottom: 20px; border-radius: 0 0 25px 25px; }
        .search-box { background: white; border: none; padding: 12px; border-radius: 15px; width: 100%; text-align: center; font-family: 'Cairo'; outline: none; }

        .section-title { padding: 20px 15px 10px; font-weight: 800; color: var(--primary); font-size: 1.1rem; }
        .product-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 10px 15px; }

        .card { background: white; border-radius: 18px; padding: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; transition: 0.3s; }
        .card:active { transform: scale(0.95); }
        .card img { width: 100%; height: 120px; object-fit: contain; border-radius: 12px; margin-bottom: 10px; }
        .card h3 { font-size: 0.85rem; margin: 5px 0; height: 35px; overflow: hidden; color: #333; }
        .price { color: #2e7d32; font-weight: 800; font-size: 1rem; display: block; margin-bottom: 10px; }

        .qty-controls { display: flex; justify-content: space-between; align-items: center; background: #f0f0f0; border-radius: 10px; padding: 4px; }
        .q-btn { border: none; width: 32px; height: 32px; border-radius: 8px; font-weight: bold; font-size: 1.2rem; cursor: pointer; }
        .q-plus { background: var(--primary); color: white; }

        .bottom-nav { position: fixed; bottom: 0; width: 100%; background: white; padding: 15px; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); display: flex; justify-content: space-around; align-items: center; border-radius: 25px 25px 0 0; z-index: 2000; }
        .cart-info { text-align: right; }
        .cart-info span { display: block; font-size: 0.8rem; color: #666; }
        .cart-info b { color: var(--primary); font-size: 1.1rem; }
        .btn-send { background: var(--primary); color: white; border: none; padding: 12px 25px; border-radius: 15px; font-weight: bold; font-family: 'Cairo'; box-shadow: 0 4px 12px rgba(139, 0, 0, 0.3); }

        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 45px; height: 45px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <p style="margin-top:15px; font-weight:bold; color:#8b0000;">Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±...</p>
</div>

<div class="app-bar">
    <h1>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ù„Ù„ØªØ³ÙˆÙŠÙ‚</h1>
</div>

<div class="search-container">
    <input type="text" id="searchInput" class="search-box" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." onkeyup="search()">
</div>

<div id="main-content" style="display:none;">
    <div class="section-title">ğŸ§´ Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</div>
    <div class="product-grid" id="cat-Ø¹Ù†Ø§ÙŠØ©"></div>
    
    <div class="section-title">âœ¨ Ø§Ù„ÙƒÙ…Ø§Ù„ÙŠØ§Øª</div>
    <div class="product-grid" id="cat-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"></div>
    
    <div class="section-title">ğŸ§¼ Ø§Ù„Ù…Ù†Ø¸ÙØ§Øª</div>
    <div class="product-grid" id="cat-Ù…Ù†Ø¸ÙØ§Øª"></div>
</div>

<div class="bottom-nav">
    <div class="cart-info">
        <span>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span>
        <b id="totalPrice">0 Ø±ÙŠØ§Ù„</b>
    </div>
    <button class="btn-send" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ğŸ›’</button>
</div>

<script>
    const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTMnmjtBmfAT7L5emSo29uOd6pj_hp5yiJcpqbXSx91s7j5UgudEjzQQytEpJSIh8dVpQeZUm5oZ_bd/pub?output=csv";
    let cart = [];

    async function loadData() {
        try {
            const res = await fetch(SHEET_URL);
            const text = await res.text();
            const rows = text.split('\n').slice(1);
            rows.forEach(r => {
                const c = r.split(',');
                if(c.length >= 5) {
                    const p = { name: c[1].trim(), price: parseInt(c[2])||0, cat: c[3].trim(), img: c[4].trim() };
                    render(p);
                }
            });
            document.getElementById('loader').style.display='none';
            document.getElementById('main-content').style.display='block';
        } catch(e) { alert("ØªØ£ÙƒØ¯ Ù…Ù† Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª"); }
    }

    function render(p) {
        let h = `
        <div class="card" data-name="${p.name}">
            <img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'">
            <h3>${p.name}</h3>
            <span class="price">${p.price} Ø±ÙŠØ§Ù„</span>
            <div class="qty-controls">
                <button class="q-btn" onclick="update('${p.name}',${p.price},'${p.img}',-1)">-</button>
                <span id="qty-${p.name}" style="font-weight:bold">0</span>
                <button class="q-btn q-plus" onclick="update('${p.name}',${p.price},'${p.img}',1)">+</button>
            </div>
        </div>`;
        let target = document.getElementById('cat-'+p.cat);
        if(target) target.innerHTML += h;
    }

    function update(name, price, img, chg) {
        if(chg === 1) cart.push({name, price, img});
        else { let i = cart.findLastIndex(x => x.name === name); if(i!==-1) cart.splice(i, 1); }
        document.getElementById('qty-'+name).innerText = cart.filter(x => x.name === name).length;
        document.getElementById('totalPrice').innerText = cart.reduce((s, x) => s + x.price, 0) + " Ø±ÙŠØ§Ù„";
    }

    function search() {
        let v = document.getElementById('searchInput').value.toLowerCase();
        document.querySelectorAll('.card').forEach(c => {
            c.style.display = c.getAttribute('data-name').toLowerCase().includes(v) ? 'block' : 'none';
        });
    }

    function sendOrder() {
        if(cart.length === 0) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!");
        let msg = "*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±*%0A";
        let summary = {};
        cart.forEach(i => { if(!summary[i.name]) summary[i.name]={q:0, p:i.price, img:i.img}; summary[i.name].q++; });
        for(let n in summary) {
            msg += `%0AğŸ“¦ *${n}* (Ø¹Ø¯Ø¯: ${summary[n].q})`;
            msg += `%0AğŸ–¼ï¸ Ø§Ù„ØµÙˆØ±Ø©: ${summary[n].img}%0A`;
        }
        msg += `%0AğŸ’° *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('totalPrice').innerText}*`;
        window.location.href = `https://wa.me/967773903010?text=${msg}`;
    }
    window.onload = loadData;
</script>
</body>
</html>
