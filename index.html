<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ù„Ù„ØªØ³ÙˆÙŠÙ‚</title>

    <link rel="icon" type="image/jpeg" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">
    <link rel="apple-touch-icon" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #8b0000; --accent: #ff4d4d; --bg: #f8f9fa; --card-bg: #ffffff; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 100px; color: #222; }

        .app-header { background: linear-gradient(135deg, var(--primary), #5a0000); color: white; padding: 45px 20px 35px; text-align: center; border-radius: 0 0 35px 35px; }
        .app-header h1 { margin: 0; font-size: 1.8rem; font-weight: 800; }
        .app-header p { margin: 10px 0 0; font-size: 0.9rem; opacity: 0.9; }

        .search-area { padding: 0 20px; margin-top: -25px; }
        .search-wrapper { background: white; display: flex; align-items: center; padding: 12px 20px; border-radius: 15px; box-shadow: 0 10px 25px rgba(0,0,0,0.1); }
        .search-wrapper input { border: none; outline: none; width: 100%; font-family: 'Cairo'; font-size: 1rem; text-align: center; }

        .section-title { padding: 25px 20px 10px; font-size: 1.2rem; font-weight: 800; color: var(--primary); }
        .horizontal-scroll { display: flex; overflow-x: auto; gap: 15px; padding: 10px 20px; }
        .horizontal-scroll::-webkit-scrollbar { display: none; }

        .product-card { background: var(--card-bg); min-width: 165px; border-radius: 22px; padding: 15px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; }
        .img-box { width: 100%; height: 130px; border-radius: 15px; background: #fff; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; overflow: hidden; }
        .img-box img { width: 100%; height: 100%; object-fit: contain; }
        .product-card h3 { font-size: 0.9rem; margin: 10px 0; height: 40px; overflow: hidden; font-weight: 700; }
        .price { color: #2e7d32; font-weight: 800; font-size: 1.1rem; display: block; margin-bottom: 12px; }

        .qty-controls { display: flex; justify-content: space-between; align-items: center; background: #f5f5f5; border-radius: 12px; padding: 4px; }
        .qty-btn { width: 36px; height: 36px; border: none; border-radius: 10px; font-size: 1.2rem; font-weight: bold; cursor: pointer; }
        .plus { background: var(--primary); color: white; }
        .minus { background: #e0e0e0; color: #444; }

        .nav-bar { position: fixed; bottom: 0; left: 0; right: 0; background: white; height: 85px; display: flex; justify-content: space-around; align-items: center; box-shadow: 0 -5px 25px rgba(0,0,0,0.08); border-radius: 30px 30px 0 0; z-index: 2000; }
        .nav-item { text-align: center; color: #777; text-decoration: none; font-size: 0.75rem; flex: 1; }
        .cart-trigger { background: var(--primary); color: white !important; width: 65px; height: 65px; border-radius: 50%; display: flex; flex-direction: column; align-items: center; justify-content: center; margin-top: -50px; border: 6px solid var(--bg); font-weight: bold; }
        
        #loading-screen { position: fixed; top:0; left:0; width:100%; height:100%; background: white; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .loader { border: 6px solid #f3f3f3; border-top: 6px solid var(--primary); border-radius: 50%; width: 55px; height: 55px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div id="loading-screen">
    <div class="loader"></div>
    <p style="margin-top:20px; font-weight:bold; color:var(--primary)">Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± ÙŠØ±Ø­Ø¨ Ø¨ÙƒÙ…...</p>
</div>

<div class="app-header">
    <h1>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ù„Ù„ØªØ³ÙˆÙŠÙ‚</h1>
    <p>Ø§Ù„Ø¬ÙˆØ¯Ø© Ø§Ù„ØªÙŠ ØªØ³ØªØ­Ù‚Ù‡Ø§ØŒ ÙˆØ§Ù„ØªÙˆÙÙŠØ± Ø§Ù„Ø°ÙŠ ØªØ¨Ø­Ø« Ø¹Ù†Ù‡ âœ¨</p>
</div>

<div class="search-area">
    <div class="search-wrapper">
        <input type="text" id="searchInput" placeholder="Ø¨Ø­Ø« Ø¹Ù† Ù…Ù†ØªØ¬..." onkeyup="search()">
    </div>
</div>

<div id="main-content" style="display:none;">
    <div id="sec-Ø¹Ù†Ø§ÙŠØ©"><div class="section-title">ğŸ§´ Ø§Ù„Ø¹Ù†Ø§ÙŠØ© Ø§Ù„Ø´Ø®ØµÙŠØ©</div><div class="horizontal-scroll" id="cont-Ø¹Ù†Ø§ÙŠØ©"></div></div>
    <div id="sec-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"><div class="section-title">âœ¨ Ø§Ù„ÙƒÙ…Ø§Ù„ÙŠØ§Øª</div><div class="horizontal-scroll" id="cont-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"></div></div>
    <div id="sec-Ù…Ù†Ø¸ÙØ§Øª"><div class="section-title">ğŸ§¼ Ø§Ù„Ù…Ù†Ø¸ÙØ§Øª</div><div class="horizontal-scroll" id="cont-Ù…Ù†Ø¸ÙØ§Øª"></div></div>
</div>

<div class="nav-bar">
    <a href="#" class="nav-item" style="color:var(--primary); font-weight:800;">ğŸ <br>Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ©</a>
    <a href="javascript:void(0)" onclick="sendOrder()" class="nav-item cart-trigger">
        <span id="cart-icon">ğŸ›’</span>
        <span id="total-price" style="font-size: 10px;">0 Ø±ÙŠØ§Ù„</span>
    </a>
    <a href="https://wa.me/967773903010" class="nav-item">ğŸ’¬<br>ØªÙˆØ§ØµÙ„ Ù…Ø¹Ù†Ø§</a>
</div>

<script>
    const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTMnmjtBmfAT7L5emSo29uOd6pj_hp5yiJcpqbXSx91s7j5UgudEjzQQytEpJSIh8dVpQeZUm5oZ_bd/pub?output=csv";
    let cart = [];

    async function loadApp() {
        try {
            const response = await fetch(SHEET_URL);
            const data = await response.text();
            const rows = data.split('\n').slice(1);
            rows.forEach(row => {
                const col = row.split(',');
                if(col.length >= 5) {
                    const p = {
                        name: col[1].replace(/"/g, '').trim(),
                        price: parseInt(col[2].trim()) || 0,
                        cat: col[3].trim(),
                        img: col[4].replace(/"/g, '').trim()
                    };
                    if(p.name) renderProduct(p);
                }
            });
            document.getElementById('loading-screen').style.display = 'none';
            document.getElementById('main-content').style.display = 'block';
        } catch (e) { console.log(e); }
    }

    function renderProduct(p) {
        let card = `
            <div class="product-card" data-name="${p.name}">
                <div class="img-box"><img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'"></div>
                <h3>${p.name}</h3>
                <span class="price">${p.price} Ø±ÙŠØ§Ù„</span>
                <div class="qty-controls">
                    <button class="qty-btn minus" onclick="updateQty('${p.name}', ${p.price}, '${p.img}', -1)">-</button>
                    <span class="qty-val" id="qty-${p.name}">0</span>
                    <button class="qty-btn plus" onclick="updateQty('${p.name}', ${p.price}, '${p.img}', 1)">+</button>
                </div>
            </div>`;
        let target = document.getElementById('cont-' + p.cat);
        if(target) target.innerHTML += card;
    }

    function updateQty(name, price, img, change) {
        if(change === 1) { cart.push({name, price, img}); }
        else { const i = cart.findLastIndex(x => x.name === name); if(i !== -1) cart.splice(i, 1); }
        document.getElementById(`qty-${name}`).innerText = cart.filter(x => x.name === name).length;
        let total = cart.reduce((s, x) => s + x.price, 0);
        document.getElementById('total-price').innerText = total + " Ø±ÙŠØ§Ù„";
        document.getElementById('cart-icon').innerHTML = cart.length > 0 ? `ğŸ›’ (${cart.length})` : 'ğŸ›’';
    }

    function search() {
        let v = document.getElementById('searchInput').value.toLowerCase();
        Array.from(document.getElementsByClassName('product-card')).forEach(c => {
            c.style.display = c.getAttribute('data-name').toLowerCase().includes(v) ? 'block' : 'none';
        });
    }

    function sendOrder() {
        if(cart.length === 0) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!");
        let msg = "*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ - Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ù„Ù„ØªØ³ÙˆÙŠÙ‚*%0A%0A";
        let summary = {};
        cart.forEach(i => {
            if(!summary[i.name]) summary[i.name] = { qty: 0, price: i.price, img: i.img };
            summary[i.name].qty++;
        });

        for(let n in summary) {
            msg += `ğŸ“¦ *${n}*%0A`;
            msg += `Ø§Ù„ÙƒÙ…ÙŠØ©: ${summary[n].qty} | Ø§Ù„Ø³Ø¹Ø±: ${summary[n].price * summary[n].qty} Ø±ÙŠØ§Ù„%0A`;
            msg += `ğŸ–¼ï¸ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©:%0A${summary[n].img}%0A`; // ÙˆØ¶Ø¹ Ø§Ù„Ø±Ø§Ø¨Ø· ÙÙŠ Ø³Ø·Ø± Ø¬Ø¯ÙŠØ¯ Ù„ÙŠØ¸Ù‡Ø± ÙƒÙ€ Ø±Ø§Ø¨Ø·
            msg += "------------------------------%0A";
        }
        msg += `%0AğŸ’° *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${cart.reduce((s, x) => s + x.price, 0)} Ø±ÙŠØ§Ù„*`;
        window.location.href = `https://wa.me/967773903010?text=${msg}`;
    }
    window.onload = loadApp;
</script>
</body>
</html>

    
