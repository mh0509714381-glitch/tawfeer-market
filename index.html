<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ù„Ù„ØªØ³ÙˆÙŠÙ‚</title>

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">
    <link rel="icon" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #8b0000; --accent: #a50000; --bg: #fdfdfd; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 160px; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± Ù…Ø¹ Ø§Ù„Ø¹Ø¨Ø§Ø±Ø© Ø§Ù„ØªØ³ÙˆÙŠÙ‚ÙŠØ© */
        .header { background: linear-gradient(135deg, var(--primary), var(--accent)); color: white; padding: 25px 10px; text-align: center; border-radius: 0 0 25px 25px; }
        .header h1 { margin: 0; font-size: 1.5rem; font-weight: 800; }
        .header .slogan { margin-top: 8px; font-size: 0.8rem; opacity: 0.9; }

        .search-container { padding: 15px; position: sticky; top: 0; background: var(--bg); z-index: 1000; }
        .search-box { display: flex; align-items: center; background: white; padding: 5px 15px; border-radius: 50px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border: 1.2px solid #eee; }
        .search-input { width: 100%; padding: 10px; border: none; outline: none; font-family: 'Cairo'; text-align: center; }

        h2 { margin: 25px 15px 10px; color: var(--primary); border-right: 5px solid var(--primary); padding-right: 12px; font-size: 1.1rem; }
        .scroll-container { display: flex; overflow-x: auto; gap: 15px; padding: 10px 15px; scrollbar-width: none; }
        .scroll-container::-webkit-scrollbar { display: none; }
        
        .product-card { background: white; min-width: 150px; max-width: 150px; padding: 12px; border-radius: 20px; text-align: center; box-shadow: 0 4px 10px rgba(0,0,0,0.03); border: 1px solid #f2f2f2; }
        .img-container { width: 100%; height: 120px; border-radius: 15px; overflow: hidden; margin-bottom: 10px; }
        .product-card img { width: 100%; height: 100%; object-fit: contain; }
        .product-card h3 { font-size: 0.8rem; margin: 8px 0; height: 35px; overflow: hidden; color: #444; }
        .price-tag { color: #2e7d32; font-weight: 800; font-size: 1rem; display: block; margin-bottom: 12px; }
        
        /* Ø£Ø²Ø±Ø§Ø± Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø±Ø§Ù‚ÙŠØ© */
        .controls { display: flex; justify-content: center; align-items: center; gap: 8px; background: #f1f1f1; border-radius: 12px; padding: 4px; }
        .btn-qty { border: none; width: 30px; height: 30px; border-radius: 8px; cursor: pointer; font-weight: 800; font-size: 1.1rem; display: flex; align-items: center; justify-content: center; }
        .btn-add { background: var(--primary); color: white; }
        .btn-remove { background: #ddd; color: #666; }
        .qty-num { font-size: 0.9rem; font-weight: bold; min-width: 20px; }

        .footer-bar { position: fixed; bottom: 0; width: 100%; background: white; padding: 20px 0; box-shadow: 0 -8px 20px rgba(0,0,0,0.08); text-align: center; border-radius: 25px 25px 0 0; z-index: 2000; }
        .confirm-btn { background: var(--primary); color: white; border: none; width: 85%; padding: 16px; border-radius: 18px; font-weight: 800; font-size: 1.1rem; cursor: pointer; }

        #loading { text-align: center; padding: 100px 20px; color: var(--primary); font-weight: bold; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸ›ï¸ Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ù„Ù„ØªØ³ÙˆÙŠÙ‚</h1>
    <div class="slogan">Ø§Ù„Ø®ÙŠØ§Ø± Ø§Ù„Ø£Ù…Ø«Ù„ Ù„Ù„Ø¬ÙˆØ¯Ø© ÙˆØ§Ù„ØªÙˆÙÙŠØ±.. ÙƒÙ„ Ù…Ø§ ØªØ­ØªØ§Ø¬Ù‡ ÙÙŠ Ù…ÙƒØ§Ù† ÙˆØ§Ø­Ø¯</div>
</div>

<div class="search-container">
    <div class="search-box">
        <input type="text" id="searchInput" class="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ù„Ø¨Ùƒ Ù‡Ù†Ø§..." onkeyup="search()">
    </div>
</div>

<div id="loading"><div class="spinner"></div>Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª...</div>

<div id="storeBody" style="display:none;">
    <div id="sec-Ø¹Ù†Ø§ÙŠØ©"><h2>ğŸ§´ Ù‚Ø³Ù… Ø§Ù„Ø¹Ù†Ø§ÙŠØ©</h2><div class="scroll-container" id="cont-Ø¹Ù†Ø§ÙŠØ©"></div></div>
    <div id="sec-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"><h2>âœ¨ Ù‚Ø³Ù… Ø§Ù„ÙƒÙ…Ø§Ù„ÙŠØ§Øª</h2><div class="scroll-container" id="cont-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"></div></div>
    <div id="sec-Ù…Ù†Ø¸ÙØ§Øª"><h2>ğŸ§¼ Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø¸ÙØ§Øª</h2><div class="scroll-container" id="cont-Ù…Ù†Ø¸ÙØ§Øª"></div></div>
</div>

<div class="footer-bar">
    <div style="margin-bottom:12px; font-weight:800;">ğŸ›’ Ø§Ù„Ø³Ù„Ø©: <span id="count">0</span> | Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="total">0</span> Ø±ÙŠØ§Ù„</div>
    <button class="confirm-btn" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ ğŸ’¬</button>
</div>

<script>
    // ØªØ£ÙƒØ¯ Ø£Ù†Ùƒ Ù‚Ù…Øª Ø¨Ø¹Ù…Ù„ Publish to the web ÙƒÙ€ CSV ÙÙŠ Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª
    const SHEET_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTMnmjtBmfAT7L5emSo29uOd6pj_hp5yiJcpqbXSx91s7j5UgudEjzQQytEpJSIh8dVpQeZUm5oZ_bd/pub?output=csv";
    
    let cart = [];

    async function fetchData() {
        try {
            const response = await fetch(SHEET_URL);
            const data = await response.text();
            const rows = data.split('\n').slice(1);
            rows.forEach(row => {
                const col = row.split(',');
                if(col.length >= 5) {
                    const p = {
                        name: col[1].replace(/"/g, '').trim(),
                        price: parseInt(col[2].trim()) || 0,
                        cat: col[3].trim(),
                        img: col[4].replace(/"/g, '').trim()
                    };
                    if(p.name) renderProduct(p);
                }
            });
            document.getElementById('loading').style.display = 'none';
            document.getElementById('storeBody').style.display = 'block';
        } catch (e) {
            document.getElementById('loading').innerHTML = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¬Ø¯ÙˆÙ„<br><small>ØªØ£ÙƒØ¯ Ù…Ù† ÙØªØ­ Ø§Ù„Ù…ØªØ¬Ø± Ø¹Ø¨Ø± Ø§Ù„Ø±Ø§Ø¨Ø· Ø§Ù„Ø±Ø³Ù…ÙŠ (Online)</small>";
        }
    }

    function renderProduct(p) {
        let card = `
            <div class="product-card" data-name="${p.name}">
                <div class="img-container"><img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'"></div>
                <h3>${p.name}</h3>
                <span class="price-tag">${p.price} Ø±ÙŠØ§Ù„</span>
                <div class="controls">
                    <button class="btn-qty btn-remove" onclick="updateQty('${p.name}', ${p.price}, -1)">-</button>
                    <span class="qty-num" id="qty-${p.name}">0</span>
                    <button class="btn-qty btn-add" onclick="updateQty('${p.name}', ${p.price}, 1)">+</button>
                </div>
            </div>`;
        let target = document.getElementById('cont-' + p.cat);
        if(target) target.innerHTML += card;
    }

    function updateQty(name, price, change) {
        if(change === 1) { cart.push({name, price}); }
        else { const i = cart.findLastIndex(x => x.name === name); if(i !== -1) cart.splice(i, 1); }
        document.getElementById(`qty-${name}`).innerText = cart.filter(x => x.name === name).length;
        document.getElementById('count').innerText = cart.length;
        document.getElementById('total').innerText = cart.reduce((s, x) => s + x.price, 0);
    }

    function search() {
        let v = document.getElementById('searchInput').value.toLowerCase();
        Array.from(document.getElementsByClassName('product-card')).forEach(c => {
            c.style.display = c.getAttribute('data-name').toLowerCase().includes(v) ? 'block' : 'none';
        });
    }

    function sendOrder() {
        if(cart.length === 0) return alert("Ø³Ù„ØªÙƒ ÙØ§Ø±ØºØ©!");
        let msg = "*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±*%0A";
        let summary = {};
        cart.forEach(i => summary[i.name] = (summary[i.name] || 0) + 1);
        for(let n in summary) msg += `â€¢ ${n} (Ø¹Ø¯Ø¯: ${summary[n]})%0A`;
        msg += `%0A*ğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('total').innerText} Ø±ÙŠØ§Ù„*`;
        window.location.href = `https://wa.me/967773903010?text=${msg}`;
    }

    window.onload = fetchData;
</script>
</body>
    </html>

