<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±</title>

    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#8b0000">
    
    <link rel="icon" type="image/jpeg" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">
    <link rel="apple-touch-icon" href="https://i.ibb.co/Hf4Xwccp/Screenshot-1.jpg">

    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
    
    <style>
        :root { --primary: #8b0000; --bg: #f8f9fa; }
        * { box-sizing: border-box; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 90px; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { background: var(--primary); color: white; padding: 35px 15px 20px; text-align: center; border-radius: 0 0 30px 30px; }
        .header h1 { margin: 0; font-size: 1.6rem; font-weight: 800; }
        
        /* Ø§Ù„Ø¨Ø­Ø« */
        .search-container { padding: 15px; margin-top: -25px; }
        .search-box { background: white; border: 1px solid #ddd; padding: 12px; border-radius: 15px; width: 100%; text-align: center; font-family: 'Cairo'; box-shadow: 0 4px 10px rgba(0,0,0,0.1); outline: none; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… */
        .section-title { padding: 20px 15px 10px; font-weight: 800; color: var(--primary); font-size: 1.2rem; }
        .product-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; padding: 10px 15px; }

        /* Ø¨Ø·Ø§Ù‚Ø© Ø§Ù„Ù…Ù†ØªØ¬ */
        .card { background: white; border-radius: 20px; padding: 12px; text-align: center; box-shadow: 0 4px 12px rgba(0,0,0,0.05); border: 1px solid #f0f0f0; }
        .card img { width: 100%; height: 120px; object-fit: contain; border-radius: 12px; }
        .card h3 { font-size: 0.85rem; margin: 10px 0; height: 35px; overflow: hidden; }
        .price { color: #2e7d32; font-weight: 800; font-size: 1.1rem; display: block; margin-bottom: 10px; }

        /* Ø§Ù„ØªØ­ÙƒÙ… ÙÙŠ Ø§Ù„Ø³Ù„Ø© */
        .qty-box { display: flex; justify-content: space-between; align-items: center; background: #f0f0f0; border-radius: 10px; padding: 5px; }
        .btn-q { border: none; width: 32px; height: 32px; border-radius: 8px; font-weight: bold; font-size: 1.2rem; cursor: pointer; }
        .plus { background: var(--primary); color: white; }

        /* Ø§Ù„Ø´Ø±ÙŠØ· Ø§Ù„Ø³ÙÙ„ÙŠ */
        .footer { position: fixed; bottom: 0; width: 100%; background: white; padding: 15px; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); display: flex; justify-content: space-around; align-items: center; border-radius: 25px 25px 0 0; z-index: 2000; }
        .order-btn { background: var(--primary); color: white; border: none; padding: 12px 30px; border-radius: 15px; font-weight: bold; font-family: 'Cairo'; font-size: 1rem; }
        
        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø³Ø±ÙŠØ¹Ø© */
        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: white; display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .spinner { border: 5px solid #f3f3f3; border-top: 5px solid var(--primary); border-radius: 50%; width: 50px; height: 50px; animation: spin 1s linear infinite; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div id="loader">
    <div class="spinner"></div>
    <p style="margin-top:15px; font-weight:bold; color:#8b0000;">Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±...</p>
</div>

<div class="header">
    <h1>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ù„Ù„ØªØ³ÙˆÙŠÙ‚</h1>
</div>

<div class="search-container">
    <input type="text" id="srch" class="search-box" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø·Ù„Ø¨Ùƒ Ù‡Ù†Ø§..." onkeyup="filter()">
</div>

<div id="content" style="display:none;">
    <div id="sec-Ø¹Ù†Ø§ÙŠØ©"><div class="section-title">ğŸ§´ Ù‚Ø³Ù… Ø§Ù„Ø¹Ù†Ø§ÙŠØ©</div><div class="product-grid" id="cat-Ø¹Ù†Ø§ÙŠØ©"></div></div>
    <div id="sec-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"><div class="section-title">âœ¨ Ù‚Ø³Ù… Ø§Ù„ÙƒÙ…Ø§Ù„ÙŠØ§Øª</div><div class="product-grid" id="cat-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"></div></div>
    <div id="sec-Ù…Ù†Ø¸ÙØ§Øª"><div class="section-title">ğŸ§¼ Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø¸ÙØ§Øª</div><div class="product-grid" id="cat-Ù…Ù†Ø¸ÙØ§Øª"></div></div>
</div>

<div class="footer">
    <div style="text-align: right;">
        <span style="font-size:0.8rem; color:#666;">Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</span><br>
        <b id="total" style="color:var(--primary); font-size:1.2rem;">0 Ø±ÙŠØ§Ù„</b>
    </div>
    <button class="order-btn" onclick="send()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ ğŸ›’</button>
</div>

<script>
    // Ø±Ø§Ø¨Ø· Ø§Ù„Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ
    const URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTMnmjtBmfAT7L5emSo29uOd6pj_hp5yiJcpqbXSx91s7j5UgudEjzQQytEpJSIh8dVpQeZUm5oZ_bd/pub?output=csv";
    let cart = [];

    async function load() {
        try {
            const res = await fetch(URL);
            if (!res.ok) throw new Error();
            const text = await res.text();
            const rows = text.split('\n').slice(1);
            rows.forEach(r => {
                const c = r.split(',');
                if(c.length >= 5) {
                    const p = { name: c[1].trim(), price: parseInt(c[2])||0, cat: c[3].trim(), img: c[4].trim() };
                    add(p);
                }
            });
            document.getElementById('loader').style.display='none';
            document.getElementById('content').style.display='block';
        } catch(e) { 
            // Ø­Ù„ Ù…Ø´ÙƒÙ„Ø© Ø§Ù„ØªØ¹Ù„ÙŠÙ‚: Ø¥Ø¸Ù‡Ø§Ø± Ø±Ø³Ø§Ù„Ø© Ø¥Ø°Ø§ ÙØ´Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª
            document.getElementById('loader').innerHTML = "<p>ÙŠØ±Ø¬Ù‰ Ø§Ù„ØªØ£ÙƒØ¯ Ù…Ù† Ø§ØªØµØ§Ù„ Ø§Ù„Ø¥Ù†ØªØ±Ù†Øª ÙˆØ­Ø§ÙˆÙ„ Ù…Ø¬Ø¯Ø¯Ø§Ù‹</p>";
        }
    }

    function add(p) {
        let h = `
        <div class="card" data-n="${p.name}">
            <img src="${p.img}" onerror="this.src='https://via.placeholder.com/150'">
            <h3>${p.name}</h3>
            <span class="price">${p.price} Ø±ÙŠØ§Ù„</span>
            <div class="qty-box">
                <button class="btn-q" onclick="upd('${p.name}',${p.price},'${p.img}',-1)">-</button>
                <span id="q-${p.name}" style="font-weight:bold">0</span>
                <button class="btn-q plus" onclick="upd('${p.name}',${p.price},'${p.img}',1)">+</button>
            </div>
        </div>`;
        let target = document.getElementById('cat-'+p.cat);
        if(target) target.innerHTML += h;
    }

    function upd(name, price, img, chg) {
        if(chg === 1) cart.push({name, price, img});
        else { let i = cart.findLastIndex(x => x.name === name); if(i!==-1) cart.splice(i, 1); }
        document.getElementById('q-'+name).innerText = cart.filter(x => x.name === name).length;
        document.getElementById('total').innerText = cart.reduce((s, x) => s + x.price, 0) + " Ø±ÙŠØ§Ù„";
    }

    function filter() {
        let v = document.getElementById('srch').value.toLowerCase();
        document.querySelectorAll('.card').forEach(c => {
            c.style.display = c.getAttribute('data-n').toLowerCase().includes(v) ? 'block' : 'none';
        });
    }

    function send() {
        if(cart.length === 0) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ©!");
        let m = "*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† ØªØ·Ø¨ÙŠÙ‚ Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±*%0A%0A";
        let s = {};
        cart.forEach(i => { if(!s[i.name]) s[i.name]={q:0, p:i.price, img:i.img}; s[i.name].q++; });
        for(let n in s) {
            m += `ğŸ“¦ *${n}* (Ø§Ù„ÙƒÙ…ÙŠØ©: ${s[n].q})%0A`;
            m += `ğŸ–¼ï¸ Ø±Ø§Ø¨Ø· Ø§Ù„ØµÙˆØ±Ø©: ${s[n].img}%0A`;
            m += `--------------------%0A`;
        }
        m += `%0AğŸ’° *Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: ${document.getElementById('total').innerText}*`;
        window.location.href = `https://wa.me/967773903010?text=${m}`;
    }
    window.onload = load;
</script>
</body>
</html>
