<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ø§Ù„ØªØ¬Ø§Ø±ÙŠ - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø§Ø³ÙŠØ©</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;800&display=swap" rel="stylesheet">
    <style>
        :root { --primary: #8b0000; --secondary: #27ae60; --bg: #f4f7f6; }
        body { font-family: 'Cairo', sans-serif; background-color: var(--bg); margin: 0; padding-bottom: 140px; overflow-x: hidden; }
        
        /* Ø§Ù„Ù‡ÙŠØ¯Ø± */
        .header { background: var(--primary); color: white; padding: 25px 10px; text-align: center; border-radius: 0 0 25px 25px; box-shadow: 0 4px 15px rgba(0,0,0,0.2); position: relative; }
        .header h1 { margin: 0; font-size: 1.6rem; font-weight: 800; letter-spacing: 1px; }

        /* Ø´Ø±ÙŠØ· Ø§Ù„Ø¨Ø­Ø« */
        .search-container { padding: 15px; position: sticky; top: 0; background: var(--bg); z-index: 1000; }
        .search-box { display: flex; align-items: center; background: white; padding: 5px 15px; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); border: 1.5px solid #eee; }
        .search-input { width: 100%; padding: 10px; border: none; outline: none; font-family: 'Cairo'; font-size: 1rem; text-align: center; }

        /* Ø§Ù„Ø£Ù‚Ø³Ø§Ù… ÙˆØ§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ† */
        h2 { margin: 25px 15px 10px; color: var(--primary); border-right: 5px solid var(--primary); padding-right: 12px; font-size: 1.2rem; font-weight: 700; }
        
        /* Ø§Ù„Ø³Ø­Ø¨ Ø§Ù„Ø£ÙÙ‚ÙŠ */
        .scroll-container { display: flex; overflow-x: auto; gap: 15px; padding: 10px 15px; scrollbar-width: none; -webkit-overflow-scrolling: touch; }
        .scroll-container::-webkit-scrollbar { display: none; }
        
        /* ÙƒØ±Øª Ø§Ù„Ù…Ù†ØªØ¬ */
        .product-card { background: white; min-width: 165px; max-width: 165px; padding: 12px; border-radius: 20px; text-align: center; box-shadow: 0 5px 15px rgba(0,0,0,0.04); border: 1px solid #efefef; transition: transform 0.2s; }
        .product-card:active { transform: scale(0.95); }
        .img-container { width: 100%; height: 130px; border-radius: 15px; overflow: hidden; background: #f9f9f9; margin-bottom: 10px; border: 1px solid #f0f0f0; }
        .product-card img { width: 100%; height: 100%; object-fit: cover; }
        .product-card h3 { font-size: 0.9rem; margin: 8px 0; color: #333; height: 40px; overflow: hidden; line-height: 1.3; }
        .price-tag { color: var(--secondary); font-weight: 800; font-size: 1.1rem; display: block; margin-bottom: 12px; }
        
        .add-btn { background: var(--primary); color: white; border: none; padding: 10px; border-radius: 12px; width: 100%; cursor: pointer; font-family: 'Cairo'; font-weight: bold; font-size: 0.9rem; display: flex; align-items: center; justify-content: center; gap: 5px; }

        /* Ø§Ù„ÙÙˆØªØ± ÙˆØ§Ù„Ø³Ù„Ø© */
        .footer-bar { position: fixed; bottom: 0; width: 100%; background: white; padding: 15px 0; box-shadow: 0 -5px 25px rgba(0,0,0,0.1); text-align: center; border-radius: 25px 25px 0 0; z-index: 2000; }
        .cart-info { margin-bottom: 10px; font-weight: bold; font-size: 1rem; color: #444; }
        .confirm-btn { background: var(--primary); color: white; border: none; width: 85%; padding: 16px; border-radius: 18px; font-weight: bold; font-size: 1.1rem; box-shadow: 0 4px 12px rgba(139,0,0,0.3); }

        /* Ø´Ø§Ø´Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„ */
        #loading { text-align: center; padding: 80px 20px; font-weight: bold; color: var(--primary); }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--primary); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

<div class="header">
    <h1>ğŸ›’ Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ± Ø§Ù„ØªØ¬Ø§Ø±ÙŠ</h1>
</div>

<div class="search-container">
    <div class="search-box">
        <input type="text" id="searchInput" class="search-input" placeholder="ğŸ” Ø§Ø¨Ø­Ø« Ø¹Ù† Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬..." onkeyup="search()">
    </div>
</div>

<div id="loading">
    <div class="spinner"></div>
    Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…ØªØ¬Ø± Ø§Ù„Ø®Ø±Ø§ÙÙŠ...
</div>

<div id="storeBody" style="display:none;">
    <div id="sec-Ø¹Ù†Ø§ÙŠØ©">
        <h2>ğŸ§´ Ù‚Ø³Ù… Ø§Ù„Ø¹Ù†Ø§ÙŠØ©</h2>
        <div class="scroll-container" id="cont-Ø¹Ù†Ø§ÙŠØ©"></div>
    </div>

    <div id="sec-ÙƒÙ…Ø§Ù„ÙŠØ§Øª">
        <h2>âœ¨ Ù‚Ø³Ù… Ø§Ù„ÙƒÙ…Ø§Ù„ÙŠØ§Øª</h2>
        <div class="scroll-container" id="cont-ÙƒÙ…Ø§Ù„ÙŠØ§Øª"></div>
    </div>

    <div id="sec-Ù…Ù†Ø¸ÙØ§Øª">
        <h2>ğŸ§¼ Ù‚Ø³Ù… Ø§Ù„Ù…Ù†Ø¸ÙØ§Øª</h2>
        <div class="scroll-container" id="cont-Ù…Ù†Ø¸ÙØ§Øª"></div>
    </div>
</div>

<div class="footer-bar">
    <div class="cart-info">ğŸ›’ Ø§Ù„Ø£ØµÙ†Ø§Ù: <span id="count">0</span> | Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <span id="total">0</span> Ø±ÙŠØ§Ù„</div>
    <button class="confirm-btn" onclick="sendOrder()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø·Ù„Ø¨ Ø¹Ø¨Ø± ÙˆØ§ØªØ³Ø§Ø¨ ğŸ’¬</button>
</div>

<script>
    // âš ï¸ Ø¶Ø¹ Ø±Ø§Ø¨Ø· Ø§Ù„Ù€ CSV Ø§Ù„Ø®Ø§Øµ Ø¨Ùƒ Ù…Ù† Ø¬ÙˆØ¬Ù„ Ø´ÙŠØª Ù‡Ù†Ø§ âš ï¸
    const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vTMnmjtBmfAT7L5emSo29uOd6pj_hp5yiJcpqbXSx91s7j5UgudEjzQQytEpJSIh8dVpQeZUm5oZ_bd/pub?output=csv";

    let cart = [];

    async function fetchProducts() {
        try {
            const response = await fetch(SHEET_CSV_URL);
            const csvData = await response.text();
            const rows = csvData.split('\n').slice(1); // ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
            
            rows.forEach(row => {
                const cols = row.split(',');
                if(cols.length >= 5) {
                    const product = {
                        id: cols[0].trim(),
                        name: cols[1].replace(/"/g, '').trim(),
                        price: parseInt(cols[2].trim()),
                        cat: cols[3].trim(),
                        img: cols[4].replace(/"/g, '').trim()
                    };
                    if(product.name) renderProduct(product);
                }
            });
            document.getElementById('loading').style.display = 'none';
            document.getElementById('storeBody').style.display = 'block';
        } catch (e) {
            document.getElementById('loading').innerHTML = "âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø¬Ø¯ÙˆÙ„!<br>ØªØ£ÙƒØ¯ Ù…Ù† Ù†Ø´Ø± Ø§Ù„Ø¬Ø¯ÙˆÙ„ ÙƒÙ€ CSV";
        }
    }

    function renderProduct(p) {
        let card = `
            <div class="product-card" data-name="${p.name}">
                <div class="img-container"><img src="${p.img}" onerror="this.src='https://via.placeholder.com/150?text=No+Image'"></div>
                <h3>${p.name}</h3>
                <span class="price-tag">${p.price} Ø±ÙŠØ§Ù„</span>
                <button class="add-btn" onclick="add('${p.name}', ${p.price})">Ø¥Ø¶Ø§ÙØ© â•</button>
            </div>`;
        
        let targetId = 'cont-' + p.cat;
        let targetContainer = document.getElementById(targetId);
        if(targetContainer) {
            targetContainer.innerHTML += card;
        }
    }

    function add(n, p) {
        cart.push({n, p});
        updateUI();
    }

    function updateUI() {
        document.getElementById('count').innerText = cart.length;
        document.getElementById('total').innerText = cart.reduce((s, x) => s + x.p, 0);
    }

    function search() {
        let v = document.getElementById('searchInput').value.toLowerCase();
        let cards = document.getElementsByClassName('product-card');
        Array.from(cards).forEach(c => {
            let name = c.getAttribute('data-name').toLowerCase();
            c.style.display = name.includes(v) ? 'block' : 'none';
        });
    }

    function sendOrder() {
        if(cart.length === 0) return alert("Ø§Ù„Ø³Ù„Ø© ÙØ§Ø±ØºØ© ÙŠØ§ Ù…Ø­Ù…Ø¯!");
        let message = "*Ø·Ù„Ø¨ Ø¬Ø¯ÙŠØ¯ Ù…Ù† Ù…ØªØ¬Ø± Ù…Ø±ÙƒØ² Ø§Ù„ØªÙˆÙÙŠØ±*%0A------------------%0A";
        cart.forEach((item, index) => {
            message += `${index + 1}. *${item.n}* - ${item.p} Ø±ÙŠØ§Ù„%0A`;
        });
        message += `%0A*ğŸ’° Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù†Ù‡Ø§Ø¦ÙŠ: ${document.getElementById('total').innerText} Ø±ÙŠØ§Ù„*`;
        window.location.href = `https://wa.me/967773903010?text=${message}`;
    }

    window.onload = fetchProducts;
</script>
</body>
</html>
